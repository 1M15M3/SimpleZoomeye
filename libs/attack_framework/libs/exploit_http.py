#coding=utf-8
import urllib
class EXPHttp():
	def __init__(self):
		pass

	'''在源字符串raw中找到最后一个ch的下标'''
	def getlastchar(self,raw,ch):
		count = 0
		sort_list = []
		for x in raw:
			if x == ch:
				sort_list.append(count)
			count += 1
		return sort_list[-1]

	'''获取标准格式的URL：http://xxx'''
	def get_standard_url(self,url,data=None):
		#判断传入的url是否为http开头
		url = url[:self.getlastchar(url,'/')]
		print 'in get_standard_url:',url
		if url.count("http") != 0:
			if data:
				if url[-1] == '/':  #http://www.xxoo.com/
					url = "%s%s" % (url,urllib.quote(data,"?@`[]*,+()/'&=!_%"))
				else:   #http://www.xxoo.com
					url = "%s/%s" % (url,urllib.quote(data,"?@`[]*,+()/'&=!_%"))
			else:
				if url[-1] == '/':  #http://www.xxoo.com/
					url = "%s" % url
				else:   #http://www.xxoo.com
					url = "%s/" % url

		else: 
			if data:
				if url[-1] ==  '/':  #www.xxoo.com/club/
					url = "http://%s%s" % (url,urllib.quote(data,"?@`[]*,+()/'&=!_%"))
				else:   #www.xxoo.com/club
					url = "http://%s/%s" % (url,urllib.quote(data,"?@`[]*,+()/'&=!_%"))
			else:
				if url[-1] ==  '/':  #www.xxoo.com/club/
					url = "http://%s" % url
				else:   #www.xxoo.com/club
					url = "http://%s/" % url
		return url

	'''登录函数'''
	def login(self,param):
		pass


if __name__ == '__main__':
	test = EXPHttp()
	print test.get_standard_url('www.discuz.net')

